Apr√®s une analyse approfondie du code backend, voici la liste des failles de s√©curit√© identifi√©es :

üî¥ FAILLES CRITIQUES
1. Stockage de mots de passe avec bcrypt rounds insuffisants
Fichier: server/routes.ts:472
Probl√®me: bcrypt.hash(password, 10) utilise seulement 10 rounds
Risque: Vuln√©rable aux attaques par force brute avec GPU modernes
Recommandation: Augmenter √† minimum 12 rounds (id√©alement 14)
2. Pas de protection contre le timing attack lors de la v√©rification OTP
Fichier: server/services/otp.ts:89
Probl√®me: record.otpCode === code est vuln√©rable au timing attack
Risque: Un attaquant peut deviner le code OTP caract√®re par caract√®re en mesurant le temps de r√©ponse
Recommandation: Utiliser crypto.timingSafeEqual() pour la comparaison
3. Validation 2FA avec fen√™tre trop large
Fichier: server/services/twoFactor.ts:32
Probl√®me: window: 2 permet 5 codes valides simultan√©ment
Risque: Augmente significativement les chances de brute force
Recommandation: R√©duire √† window: 1
4. Pas de rotation automatique des secrets 2FA
Fichier: server/services/twoFactor.ts
Probl√®me: Les secrets 2FA ne sont jamais renouvel√©s
Risque: Si compromis, le secret reste valide ind√©finiment
Recommandation: Impl√©menter une rotation p√©riodique (tous les 90 jours)
5. OTP codes pr√©visibles
Fichier: server/services/otp.ts:29
Probl√®me: crypto.randomInt(100000, 999999) g√©n√®re des codes √† 6 chiffres uniquement
Risque: 1 million de combinaisons possibles - brute force faisable
Recommandation: Augmenter √† 8 chiffres OU ajouter des lettres
üü† FAILLES MOYENNES
6. Nettoyage des OTP expir√©s non automatique
Fichier: server/services/otp.ts:110-118
Probl√®me: La fonction cleanupExpiredOTPs() existe mais n'est jamais appel√©e automatiquement
Risque: Accumulation de donn√©es sensibles en base
Recommandation: Impl√©menter un cron job pour nettoyer toutes les heures
7. Limite d'essais OTP par utilisateur insuffisante
Fichier: server/services/otp.ts:63
Probl√®me: MAX_OTP_ATTEMPTS = 3 mais pas de blocage temporaire apr√®s √©chec
Risque: Un attaquant peut g√©n√©rer de nouveaux OTP infiniment
Recommandation: Ajouter un d√©lai exponentiel apr√®s √©checs multiples
8. Pas de validation de l'origine des requ√™tes sensibles
Fichier: Multiple routes
Probl√®me: Pas de v√©rification de header Origin ou Referer pour op√©rations sensibles
Risque: Possible CSRF malgr√© le token (si le token est vol√©)
Recommandation: Ajouter validation suppl√©mentaire pour transferts/pr√™ts
9. Session fixation possible
Fichier: server/routes.ts:548-560
Probl√®me: req.session.regenerate() appel√© mais pas syst√©matiquement apr√®s changement de privil√®ges
Risque: Session fixation attack
Recommandation: R√©g√©n√©rer l'ID de session √† chaque √©l√©vation de privil√®ge
10. Pas de signature des cookies de session
Fichier: server/index.ts:138-151
Probl√®me: Pas de signature explicite des cookies (juste httpOnly)
Risque: Possible manipulation de cookies
Recommandation: Ajouter signed: true dans les options de cookie
üü° FAILLES MINEURES / AM√âLIORATIONS
11. Rate limiting insuffisant pour certains endpoints
Fichier: server/routes.ts:111-117
Probl√®me: generalApiLimiter permet 100 requ√™tes/15min - trop permissif
Risque: DoS possible sur certains endpoints
Recommandation: R√©duire √† 50 requ√™tes/15min
12. Logs de production trop verbeux
Fichier: server/index.ts:73-74, 276-281
Probl√®me: Logs de configuration en production exposent des d√©tails
Risque: Information disclosure
Recommandation: R√©duire les logs en production
13. Pas de Content Security Policy stricte
Fichier: server/index.ts:90-106
Probl√®me: CSP permet unsafe-inline et unsafe-eval en dev (risque si code passe en prod)
Risque: XSS possible
Recommandation: S√©parer compl√®tement dev/prod CSP
14. Validation des fichiers upload√©s insuffisante
Fichier: server/routes.ts:389-420
Probl√®me: Validation bas√©e uniquement sur extension et MIME type
Risque: Upload de fichiers malveillants d√©guis√©s
Recommandation: Analyser le contenu r√©el du fichier (magic bytes)
15. Pas de d√©tection d'anomalies de connexion
Fichier: Manquant
Probl√®me: Pas de d√©tection de connexions depuis nouvelles localisations/devices
Risque: Comptes compromis non d√©tect√©s
Recommandation: Impl√©menter fingerprinting + alertes
16. Tokens de r√©initialisation de mot de passe valides trop longtemps
Fichier: Pas visible dans le code fourni
Probl√®me: Si > 1 heure, c'est trop
Recommandation: Limiter √† 15-30 minutes maximum
17. Pas de limite sur le nombre de sessions actives
Fichier: server/routes.ts:276-282
Probl√®me: V√©rifie seulement activeSessionId mais pas de limite globale
Risque: Un attaquant peut cr√©er de nombreuses sessions
Recommandation: Limiter √† 3-5 sessions actives max par utilisateur

Corrige tout les failles